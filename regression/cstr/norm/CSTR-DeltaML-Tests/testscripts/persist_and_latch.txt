#
# Test of DML problem persistence gate and logic latch
#
Test: Persistence and Latching
Show: browser "CSTR_PRODUCT_QUALITY-GDA/CSTR_DML_PROBLEM-GDA/Cstr_Dml_Problem"
# Show: browser $problem

# Define data written to tags in the order: connectionIn
Tagset: externaldata
Step: Check Reset Condition
09:38:00 null
09:38:15 resetDiagram("CSTR_PRODUCT_QUALITY-GDA/CSTR_DML_PROBLEM-GDA/Cstr_Dml_Problem")
log: [DATE] [TIME] affirm reset action -- completion of reset will register source connection passing false to donwstream blocks
09:39:30 Assert: Connection = NaN "connection in reset state"
09:39:35 Assert: Persist = UNKNOWN "persistence in reset state"
09:39:40 Assert: Latch = FALSE "latch in reset state"
# 09:39:00 Assert: Connection = false "connection in reset state"
# 09:39:00 Assert: Persist = false "persistence in reset state"
# 09:39:00 Assert: Latch = false "latch in reset state"

Step: Initial State Confirmation
log: [DATE] [TIME] affirm input 
# affirm input at nontest values - make sure values change
09:39:50 UNKNOWN
09:40:00 FALSE
09:40:30 Assert: Connection = FALSE "connection initialized to false state"
09:40:35 Assert: Persist =FALSE "persistence passes false immediately"
09:40:40 Assert: Latch = FALSE "latch receives false from persistence"

Step: Data Persistence Test
log: [DATE] [TIME] [TTIME] begin testing persistence - send a TRUE
09:40:45 TRUE 
09:41:30 Assert: Connection = TRUE "connection gets a TRUE input"
09:41:35 Assert: Persist = false "TRUE should not be propagated to out port"
09:41:45 Assert: Latch = false "no new data for latch"
09:51:00 Assert: Persist = true "clock has run out on persistence out port updated"
log: [DATE] [TIME] [TTIME] counter on persistence block as run down - pass the true to latch
09:51:15 Assert: Latch = true "hold this thought"

09:53:00 FALSE
09:54:30 Assert: Connection = FALSE "resetting states"
09:54:45 Assert: Persist = FALSE "persistence passes immediately"
09:54:50 Assert: Latch = FALSE "false passed to latch"

09:56:00 TRUE
log: [DATE] [TIME] [TTIME] Sending a true condition
09:56:30 Assert: Connection = TRUE "testing cancel logic"
09:56:45 Assert: Persist = FALSE "counting -- count not available to script"
09:56:50 Assert: Latch = FALSE "no new data to latch"
10:00:00 FALSE
log: [DATE] [TIME] [TTIME] rescinding true condtion from 09:56 - 6 min on counter
10:00:20 Assert: Connection = FALSE "cancelling last true condition"
10:00:30 Assert: Persist = FALSE "cancelling counting in persistence block"
10:07:00 Assert: Latch = FALSE "never got the true condition which was rescinded at 10:00"
log: [DATE] [TIME] [TTIME] confirmed that latch did not get a true condition