#!/bin/sh
#
# Save the source tree for blt, block and common into a zip repository.
# Do not intentionally include build products. Make clean before 
# running this script.
#
#set -x
REPO_ROOT=~/Development/ils/repo
SVN=~/Development/ils/svn/EMChemicals
VERS=ils-java-src
TMP=$REPO_ROOT/$VERS
# Cleanup
rm -rf $TMP
cd $REPO_ROOT
rm -rf external/cachedir
rm -rf block/workspace/Block*/bin/*
rm -rf blt/workspace/BLT_*/bin/*
rm -rf blt/workspace/BLT_Build/temp_modl
rm -rf common/workspace/ILS_Common/bin/*
rm -rf common/workspace/ILS_Common/doc/*
rm -rf common/workspace/doc/*
rm -rf sfc/workspace/sfc-*/bin/*
rm -rf sfc/workspace/sfc-build/temp_modl
mkdir $TMP
mkdir -p $TMP/block/workspace
mkdir -p $TMP/common/workspace
mkdir -p $TMP/blt
cp -a setup external ignition-77 $TMP
cp -a block/workspace/Block $TMP/block/workspace
cp -a common/workspace/ILS_Common $TMP/common/workspace
cp -a blt $TMP
cp -a sfc $TMP
# Scrub the temp area before zipping
cd $TMP
rm -f external/lib/user-ex* 
rm -f external/lib/g2-ex* 
rm -f external/lib/cachedir
rm -rf blt/.metadata
rm -rf blt/.recommenders

# Now zip and copy to subversion
cd $REPO_ROOT/$VERS
zip -r ils-java-src.zip *
cp ils-java-src.zip $SVN/Release/src
rm -rf $TMP
